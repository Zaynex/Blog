<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="但行好事，莫问前程">
<meta property="og:type" content="website">
<meta property="og:title" content="如是而已">
<meta property="og:url" content="https://zaynex.github.io/index.html">
<meta property="og:site_name" content="如是而已">
<meta property="og:description" content="但行好事，莫问前程">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="如是而已">
<meta name="twitter:description" content="但行好事，莫问前程">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="https://zaynex.github.io/"/>

  <title> 如是而已 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?af076e316f8f5bf2f10120a932bafe01";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">如是而已</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/09/新浪浙江笔试题/" itemprop="url">
                  记一发前端笔试题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-09T22:28:25+08:00" content="2016-11-09">
              2016-11-09
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/11/09/新浪浙江笔试题/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/09/新浪浙江笔试题/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="HTML-CSS部分"><a href="#HTML-CSS部分" class="headerlink" title="HTML/CSS部分"></a>HTML/CSS部分</h2><h3 id="display-none-和-visibility-hidden"><a href="#display-none-和-visibility-hidden" class="headerlink" title="display:none 和 visibility:hidden"></a><code>display:none</code> 和 <code>visibility:hidden</code></h3><p><code>display:none</code>：关闭一个元素的显示（对布局没有影响）；其所有后代元素都也被会被关闭显示。文档渲染时，该元素如同不存在。<br><code>visibility:hidden</code>：隐藏元素，但是其他元素的布局不改变，相当于此元素变成透明。要注意若将其子元素设为 visibility: visible，则该子元素依然可见。</p>
<p>注意两点区别:</p>
<ol>
<li>文档渲染的区别，为none时不加载，我记得在某本书里有提到这种措施，可以减少重绘和回流;</li>
<li>前者不占据宽高，页面不显示，后者占据相应的宽高;</li>
<li>前者后代元素也跟随该元素消失，后者子代元素依然可见。</li>
</ol>
<h4 id="重绘与回流"><a href="#重绘与回流" class="headerlink" title="重绘与回流"></a>重绘与回流</h4><p>#####为什么不none时不加载呢？</p>
<blockquote>
<p>DOM Tree 和样式结构体组合后构建render tree, render tree类似于DOM tree，但区别很大，render tree能识别样式，render tree中每个NODE都有自己的style，而且 render tree不包含隐藏的节点 (比如display:none的节点，还有head节点)，因为这些节点不会用于呈现，而且不会影响呈现的，所以就不会包含到 render tree中。注意 visibility:hidden隐藏的元素还是会包含到 render tree中的，因为visibility:hidden 会影响布局(layout)，会占有空间。根据CSS2的标准，render tree中的每个节点都称为Box (Box dimensions)，理解页面元素为一个具有填充、边距、边框和位置的盒子。</p>
</blockquote>
<p>参考<a href="http://www.css88.com/archives/4996" target="_blank" rel="external">页面重绘和回流以及优化</a></p>
<p>#####回流与重绘</p>
<ol>
<li>当render tree中的一部分(或全部)因为元素的规模尺寸，布局，隐藏等改变而需要重新构建。这就称为回流(reflow)。每个页面至少需要一次回流，就是在页面第一次加载的时候。在回流的时候，浏览器会使渲染树中受到影响的部分失效，并重新构造这部分渲染树，完成回流后，浏览器会重新绘制受影响的部分到屏幕中，该过程成为重绘。</li>
<li>当render tree中的一些元素需要更新属性，而这些属性只是影响元素的外观，风格，而不会影响布局的，比如background-color。则就叫称为重绘。<br><em>注意：回流必将引起重绘，而重绘不一定会引起回流。</em></li>
</ol>
<p>#####show me the code<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var s = document.body.style;</div><div class="line">s.padding = &quot;2px&quot;; // 回流+重绘</div><div class="line">s.border = &quot;1px solid red&quot;; // 再一次 回流+重绘</div><div class="line">s.color = &quot;blue&quot;; // 再一次重绘</div><div class="line">s.backgroundColor = &quot;#ccc&quot;; // 再一次 重绘</div><div class="line">s.fontSize = &quot;14px&quot;; // 再一次 回流+重绘</div><div class="line">// 添加node，再一次 回流+重绘</div><div class="line">document.body.appendChild(document.createTextNode(&apos;abc!&apos;));</div></pre></td></tr></table></figure></p>
<p>但是浏览器也不傻，他们会把这些操作放入到队列里，等到一定数量或者一定间隔再执行操作，就可以减少回流重绘。</p>
<h3 id="行内元素和块级元素"><a href="#行内元素和块级元素" class="headerlink" title="行内元素和块级元素"></a>行内元素和块级元素</h3><p>行内元素:<code>padding</code>在四个方向都是有效果的。<code>margin</code>中<code>margin-left</code>,<code>margin-right</code>有效果，其他无效。<code>width</code>和<code>height</code>都有无效，但<code>line-height</code>有效。<br>可以自己测试下。(发现网上有些博客说<code>padding-bottom</code>无效,不知道是怎么来的，如果你在自己的浏览器环境下测试得出不一样的结论欢迎补充！)</p>
<p>默认情况下，块级元素会新起一行。<br>块级元素定义：当元素的 CSS 属性  display 为 block, list-item 或 table 时，它是块级元素 block-level 。块级元素（比如</p><p>)视觉上呈现为块，竖直排列。</p>
<p>块级盒(块格式化上下文 block formatting context)：每个块级元素至少生成一个块级盒，称为主要块级盒(principal block-level box)。一些元素，比如<code>&lt;li&gt;</code>，生成额外的盒来放置项目符号，不过多数元素只生成一个主要块级盒。 主要块级盒将包含后代元素生成的盒以及生成的内容。</p>
<p>这块还需要再仔细研究下。<a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Visual_formatting_model#.E8.A1.8C.E5.86.85.E7.BA.A7.E5.85.83.E7.B4.A0.E4.B8.8E.E8.A1.8C.E5.86.85.E7.9B.92(Inline-level_elements_and_inline_boxes" target="_blank" rel="external">MDN</a>)</p>
<p>一般情况下，行内元素只能包含数据和其他行内元素。<br>而块级元素可以包含行内元素和其他块级元素。这种结构上的包含继承区别可以使块级元素创建比行内元素更”大型“的结构。</p>
<h3 id="IEhack"><a href="#IEhack" class="headerlink" title="IEhack"></a>IEhack</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">.ie6_7_8&#123;</div><div class="line">    color:blue; /*所有浏览器*/</div><div class="line">    color:red\9; /*IE8以及以下版本浏览器*/</div><div class="line">    *color:green; /*IE7及其以下版本浏览器*/</div><div class="line">    _color:purple; /*IE6浏览器*/</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>!important</code>的IE hack手段</p>
<blockquote>
<p>网上很多资料中常常把!important也作为一个hack手段，其实这是一个误区。!important常常被我们用来更改样式，而不是兼容hack。造成这个误区的原因是IE6在某些情况下不主动识别!important,以至于常常被人误用做识别IE6的hack。可是，大家注意一下，IE6只是在某些情况下不识别（ie6下，同一个大括号里对同一个样式属性定义，其中一个加important 则important标记是被忽略的，例：{background:red!important; background:green;} ie6下解释为背景色green，其它浏览器解释为背景色red；如果这同一个样式在不同大括号里定义，其中一个加important 则important发挥正常作用，例：div{background:red!important} div{background:green}，这时所有浏览器统一解释为背景色red。）<br><a href="http://www.duitang.com/static/csshack.html" target="_blank" rel="external">参考地址</a></p>
</blockquote>
<h2 id="JS部分"><a href="#JS部分" class="headerlink" title="JS部分"></a>JS部分</h2><h3 id="typeof类型判断"><a href="#typeof类型判断" class="headerlink" title="typeof类型判断"></a>typeof类型判断</h3><ul>
<li>“undefined”(随便给一个变量)</li>
<li>“object” (包括typeof Null)</li>
<li>“string”</li>
<li>“function”(比如alert)</li>
<li>“number”</li>
<li>“boolean”</li>
<li>“symbol”(ES6新增)<h4 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typeof</span> /s/ === <span class="string">'function'</span>; <span class="comment">// Chrome 1-12 , 不符合 ECMAScript 5.1</span></div><div class="line"><span class="keyword">typeof</span> /s/ === <span class="string">'object'</span>; <span class="comment">// Firefox 5+ , 符合 ECMAScript 5.1</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>遇到的题：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typeof</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="string">"a"</span>][<span class="number">1</span>,<span class="number">2</span>];</div></pre></td></tr></table></figure></p>
<p>嗯，猜猜这是什么类型？<br>这题其实考的其实是逗号表达式，后面<code>[1,2]</code>取的是2,所以数组里第2个就是<code>&quot;a&quot;</code>(“string”类型),当时以为是object，好伤感。</p>
<h3 id="跨域的几种方式"><a href="#跨域的几种方式" class="headerlink" title="跨域的几种方式"></a>跨域的几种方式</h3><p>####jsonp<br>因为通过script标签引入的js是不受同源策略的限制的。所以我们可以通过script标签引入一个js或者是一个其他后缀形式（如php，jsp等）的文件，此文件返回一个js函数的调用。<br>比如，有个a.html页面，它里面的代码需要利用ajax获取一个不同域上的json数据，假设这个json数据地址是<code>http://damonare.cn/data.php</code>, 那么<code>a.html</code>中的代码就可以这样</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">dosomething</span>(<span class="params">jsondata</span>)</span>&#123;</div><div class="line">        <span class="comment">//处理获得的json数据</span></div><div class="line">    &#125;</div><div class="line">&lt;\/script&gt;</div><div class="line"><span class="comment">//因为是markdown写的，所以页面显示内容可能有部分差异</span></div><div class="line">&lt;script src=\<span class="string">"http://example.com/data.php?callback=dosomething"</span>&gt;&lt;\/script&gt;</div></pre></td></tr></table></figure>
<p>我们看到获取数据的地址后面还有一个callback参数，按惯例是用这个参数名，但是你用其他的也一样。当然如果获取数据的jsonp地址页面不是你自己能控制的，就得按照提供数据的那一方的规定格式来操作了。</p>
<p>因为是当做一个js文件来引入的，所以<a href="http://damonare.cn/data.php" target="_blank" rel="external">http://damonare.cn/data.php</a> 返回的必须是一个能执行的js文件，所以这个页面的php代码可能是这样的(一定要和后端约定好哦):<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$callback = $_GET[<span class="string">'callback'</span>];<span class="comment">//得到回调函数名</span></div><div class="line">$data = <span class="keyword">array</span>(<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>);<span class="comment">//要返回的数据</span></div><div class="line"><span class="keyword">echo</span> $callback.<span class="string">'('</span>.json_encode($data).<span class="string">')'</span>;<span class="comment">//输出</span></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>最终输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dosomething([&apos;a&apos;,&apos;b&apos;,&apos;c&apos;]);</div></pre></td></tr></table></figure></p>
<h5 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h5><ul>
<li>它不像XMLHttpRequest对象实现的Ajax请求那样受到同源策略的限制；它的兼容性更好，在更加古老的浏览器中都可以运行，不需要XMLHttpRequest或ActiveX的支持；并且在请求完毕后可以通过调用callback的方式回传结果。</li>
<li>它只支持GET请求而不支持POST等其它类型的HTTP请求；它只支持跨域HTTP请求这种情况，不能解决不同域的两个页面之间如何进行JavaScript调用的问题。</li>
</ul>
<h3 id="获取URL参数转换为对象"><a href="#获取URL参数转换为对象" class="headerlink" title="获取URL参数转换为对象"></a>获取URL参数转换为对象</h3><p>这里是《JavaScript高级程序设计三》里的原函数，注意使用的是 <code>location.search</code>返回的字符串是以<code>?</code>开头的,所以这里还需要加一个<code>substring(1)</code>表示从<code>?</code>之后取字符串<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getQueryStringArgs</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> qs = (location.search.length &gt; <span class="number">0</span> ? location.search.substring(<span class="number">1</span>) : <span class="string">""</span>),</div><div class="line">        args = &#123;&#125;,</div><div class="line">    items = qs.length ? qs.split(<span class="string">'&amp;'</span>) : [], </div><div class="line">    item = <span class="literal">null</span>,</div><div class="line">    name =  <span class="literal">null</span>,</div><div class="line">    valu = <span class="literal">null</span>,</div><div class="line">    i = <span class="number">0</span>,</div><div class="line">    len = items.length;</div><div class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; len; i++)&#123;</div><div class="line">        item = items[i].split(<span class="string">"="</span>);</div><div class="line">        name = <span class="built_in">decodeURIComponent</span>(item[<span class="number">0</span>]);</div><div class="line">        value = <span class="built_in">decodeURIComponent</span>(item[<span class="number">1</span>]);</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(name.length)&#123;</div><div class="line">            args[name] = value;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> args;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>当然，为了演示方便，我们可以直接传一个url参数到里面再做解析。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">parseQueryString</span>(<span class="params">url</span>)</span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">var</span> obj=&#123;&#125;;</div><div class="line">        <span class="keyword">var</span> keyvalue=[];</div><div class="line">        <span class="keyword">var</span> key=<span class="literal">null</span>,value=<span class="literal">null</span>;       </div><div class="line">        <span class="keyword">var</span> paraString=url.substring(url.lastIndexOf(<span class="string">"?"</span>)+<span class="number">1</span>,url.length).split(<span class="string">"&amp;"</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> paraString)</div><div class="line">        &#123;</div><div class="line">            keyvalue = paraString[i].split(<span class="string">"="</span>);</div><div class="line">            key = <span class="built_in">decodeURIComponent</span>(keyvalue[<span class="number">0</span>]);</div><div class="line">            value = <span class="built_in">decodeURIComponent</span>(keyvalue[<span class="number">1</span>]);</div><div class="line">            obj[key]=value;            </div><div class="line">        &#125;        </div><div class="line">        <span class="keyword">return</span> obj;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> w3w = <span class="string">"http://blog.sina.com.cn/s/blog_5082f7b901015r2r.html?key1=1&amp;value=2"</span>;</div><div class="line"><span class="built_in">console</span>.log(parseQueryString(w3w));</div></pre></td></tr></table></figure></p>
<p>其实流程和上面的一样。<br><code>split()</code> 方法通过把字符串分割成子字符串来把一个 String 对象分割成一个字符串数组。<br><code>substring()</code> 返回字符串两个索引之间（或到字符串末尾）的子串。</p>
<ol>
<li>取出<code>?</code>之后的查询字符串参数</li>
<li>以<code>&amp;</code>为分割符划分为不同的字符串数组</li>
<li>再以<code>=</code>为分割符划分<code>key</code>和<code>value</code></li>
<li>保存到新的对象中<h3 id="随机排序"><a href="#随机排序" class="headerlink" title="随机排序"></a>随机排序</h3>写一段代码，随机排序array([1,2,3,4,5,6,7,8,9])。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">//我自己写的</div><div class="line">function array(arr)&#123;</div><div class="line">    var N = arr.length;</div><div class="line">    var newArr = [];</div><div class="line">    for(var i = 0; i &lt; N; i++)&#123;</div><div class="line">        if(Math.random() &gt; 0.5)&#123;</div><div class="line">            newArr.push(arr[i]);</div><div class="line">        &#125;else&#123;</div><div class="line">            newArr.unshift(arr[i]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return newArr;</div><div class="line">&#125;</div><div class="line">//利用Math.random随机判断插入顺序</div><div class="line"></div><div class="line">//再看看大师的作品(洗牌算法)</div><div class="line">function knuth(arr)&#123;</div><div class="line">    var N = arr.length;</div><div class="line">    for(var i = 0; i &lt; N; i++)&#123;</div><div class="line">        //保证每个数都能与后面一个数字进行交换</div><div class="line">        var r = i + Math.floor(Math.random()*(N - i));</div><div class="line">        var temp = arr[r];</div><div class="line">        arr[r] = arr[i];</div><div class="line">        arr[i] = temp;</div><div class="line">        console.log(&quot;r现在是 &quot; + r);</div><div class="line">    &#125;</div><div class="line">    return arr;</div><div class="line">&#125;</div><div class="line">//还可以这样</div><div class="line">str.sort(function()&#123;</div><div class="line">    return (0.5 - Math.random());</div><div class="line">&#125;);</div><div class="line"></div><div class="line">//ES6</div><div class="line">function shuffle(arr)&#123;</div><div class="line">    let n = arr.length,random;</div><div class="line">    while(0!=n)&#123;</div><div class="line">        random = (Math.random()*n--) &gt;&gt;&gt; 0; //无符号右移运算符向下取整</div><div class="line">        [arr[n], arr[random]] = [arr[random], arr[n]];</div><div class="line">    &#125;</div><div class="line">    return arr;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="实现Drag功能"><a href="#实现Drag功能" class="headerlink" title="实现Drag功能"></a>实现Drag功能</h3><p>HTML5自带拖拽，但这里主要用原生JS去实现：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=&quot;en&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">    &lt;title&gt;Document&lt;/title&gt;</div><div class="line">    &lt;style&gt;</div><div class="line">        div,body&#123;</div><div class="line">            padding: 0;</div><div class="line">            margin: 0;</div><div class="line">        &#125;</div><div class="line">        #drag&#123;</div><div class="line">            width: 100px;</div><div class="line">            height: 100px;</div><div class="line">            background: red;</div><div class="line">            position: absolute;</div><div class="line">        &#125;</div><div class="line">    &lt;/style&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">    &lt;div id=&quot;drag&quot;&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line"></div><div class="line">    &lt;script&gt;</div><div class="line">        window.onload = function()&#123;</div><div class="line">            drag.onmousedown = function(event)&#123;</div><div class="line">                </div><div class="line">                event = window.event || event;</div><div class="line">                var drag = document.querySelector(&apos;#drag&apos;);</div><div class="line">                var disX = event.clientX - drag.offsetLeft;</div><div class="line">                var disY = event.clientY - drag.offsetTop;</div><div class="line"></div><div class="line">                drag.onmousemove = function(event)&#123;</div><div class="line">                    event = window.event || event;</div><div class="line">                    drag.style.left = event.clientX - disX + &quot;px&quot;;</div><div class="line">                    drag.style.top = event.clientY - disY + &quot;px&quot;;</div><div class="line">                &#125;</div><div class="line">                drag.onmouseup = function(evebt)&#123;</div><div class="line">                    drag.onmouseup = null;</div><div class="line">                    drag.onmousemove = null;</div><div class="line">                &#125;</div><div class="line">            &#125;;</div><div class="line">        &#125;</div><div class="line">    &lt;/script&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<p>这么写太low了。要参考高程的逼格去写啊。<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;div id="drag" class="draggable"&gt;</div><div class="line">    &lt;/div&gt;</div></pre></td></tr></table></figure></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Drag = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> dragging = <span class="literal">null</span>,</div><div class="line">                disX = <span class="number">0</span>,</div><div class="line">                disY = <span class="number">0</span>;</div><div class="line">            <span class="function"><span class="keyword">function</span> <span class="title">handlerEvent</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">                event = <span class="built_in">window</span>.event || event;</div><div class="line">                <span class="keyword">var</span> target = event.target || event.srcElement;</div><div class="line"></div><div class="line">                <span class="keyword">switch</span>(event.type)&#123;</div><div class="line">                    <span class="keyword">case</span> <span class="string">"mousedown"</span>: </div><div class="line">                        <span class="keyword">if</span>(target.className.indexOf(<span class="string">"draggable"</span>) &gt; <span class="number">-1</span>)&#123;</div><div class="line">                            dragging = target;</div><div class="line">                            disX = event.clientX - target.offsetLeft;</div><div class="line">                            disY = event.clientY - target.offsetTop;</div><div class="line">                        &#125;;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    <span class="keyword">case</span> <span class="string">"mousemove"</span>:</div><div class="line">                        <span class="keyword">if</span>(dragging !== <span class="literal">null</span>)&#123;</div><div class="line">                            dragging.style.left = event.clientX - disX + <span class="string">"px"</span>;</div><div class="line">                            dragging.style.top = event.clientY - disY + <span class="string">"px"</span>;</div><div class="line">                        &#125;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    <span class="keyword">case</span> <span class="string">"mouseup"</span>:</div><div class="line">                        dragging = <span class="literal">null</span>;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                &#125;   </div><div class="line">            &#125;;</div><div class="line">            <span class="keyword">return</span> &#123;</div><div class="line">                enable: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                    <span class="built_in">document</span>.addEventListener(<span class="string">"mousedown"</span>,handlerEvent, <span class="literal">false</span>);</div><div class="line">                    <span class="built_in">document</span>.addEventListener(<span class="string">"mousemove"</span>,handlerEvent, <span class="literal">false</span>);</div><div class="line">                    <span class="built_in">document</span>.addEventListener(<span class="string">"mouseup"</span>,handlerEvent, <span class="literal">false</span>);   </div><div class="line">                &#125;,</div><div class="line">                disable: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                    <span class="built_in">document</span>.removeEventListener(<span class="string">"mousedown"</span>,handlerEvent, <span class="literal">false</span>);</div><div class="line">                    <span class="built_in">document</span>.removeEventListener(<span class="string">"mousemove"</span>,handlerEvent, <span class="literal">false</span>);</div><div class="line">                    <span class="built_in">document</span>.removeEventListener(<span class="string">"mouseup"</span>,handlerEvent, <span class="literal">false</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;;</div><div class="line">        &#125;();</div><div class="line">        Drag.enable();</div></pre></td></tr></table></figure>
<h3 id="运动框架"><a href="#运动框架" class="headerlink" title="运动框架"></a>运动框架</h3><p>这道题主要是对一个物体进行移动，并且实现透明度相应的变化。<br>从x=100,y=100移动到x=10,y=10，移动过程中实现透明度等于x值。<br>最好是能封装一个比较通用的函数。手写代码还真是感觉不一样，说明自己掌握的还是很薄弱。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;div id=&quot;dialog&quot; class=&quot;box&quot;&gt;&lt;/div&gt;</div><div class="line">&lt;button class=&apos;jclick&apos;&gt;啦啦啦&lt;/button&gt;</div></pre></td></tr></table></figure></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//这段函数获取样式表和行内样式</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getStyle</span>(<span class="params">obj, attr</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(obj.currentStyle)&#123;</div><div class="line">        <span class="keyword">return</span> obj.currentStyle[attr];</div><div class="line">    &#125;<span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> getComputedStyle(obj,<span class="literal">false</span>)[attr];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">startMove</span>(<span class="params">obj, json, fn</span>)</span>&#123;</div><div class="line">    clearInterval(obj.timer);</div><div class="line">    obj.timer = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> bStop = <span class="literal">true</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> attr <span class="keyword">in</span> json)&#123;</div><div class="line">            <span class="keyword">var</span> iCur = <span class="number">0</span>;</div><div class="line">            <span class="keyword">if</span>(attr === <span class="string">'opacity'</span>)&#123;</div><div class="line">                iCur = <span class="built_in">parseInt</span>(<span class="built_in">parseFloat</span>(getStyle(obj,attr))*<span class="number">100</span>);</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                iCur = <span class="built_in">parseInt</span>(getStyle(obj, attr));</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">var</span> iSpeed = (json[attr] - iCur)/<span class="number">8</span>;</div><div class="line">            iSpeed = iSpeed &gt; <span class="number">0</span> ? <span class="built_in">Math</span>.ceil(iSpeed): <span class="built_in">Math</span>.floor(iSpeed);</div><div class="line"></div><div class="line">            <span class="keyword">if</span>(iCur != json[attr])&#123;</div><div class="line">                bStop = <span class="literal">false</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(attr == <span class="string">'opacity'</span>)&#123;</div><div class="line">                obj.style.filter = <span class="string">'alpha(opacity:'</span> + (iCur+iSpeed)+<span class="string">')'</span>;</div><div class="line">                obj.style.opacity = (iCur + iSpeed)/ <span class="number">100</span>;</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                obj.style[attr] = iCur + iSpeed + <span class="string">"px"</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(bStop)&#123;</div><div class="line">            clearInterval(obj.timer);</div><div class="line">            <span class="keyword">if</span>(fn)&#123;</div><div class="line">                fn();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;,<span class="number">30</span>)</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> dialog = <span class="built_in">document</span>.getElementById(<span class="string">"dialog"</span>);</div><div class="line"><span class="keyword">var</span> jclick = <span class="built_in">document</span>.querySelector(<span class="string">".jclick"</span>);</div><div class="line"><span class="comment">//这段函数严重的问题，地狱回调啊</span></div><div class="line">jclick.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        startMove(dialog, &#123;left:<span class="number">10</span>,top:<span class="number">10</span>,opacity:<span class="number">10</span>&#125;,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">            startMove(dialog, &#123;left:<span class="number">100</span>,top:<span class="number">100</span>,opacity:<span class="number">100</span>&#125;,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                startMove(dialog, &#123;left:<span class="number">1220</span>,top:<span class="number">100</span>,opacity:<span class="number">100</span>&#125;,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                    startMove(dialog, &#123;left:<span class="number">120</span>,top:<span class="number">100</span>,opacity:<span class="number">10</span>&#125;);</div><div class="line">                &#125;)</div><div class="line">            &#125;);</div><div class="line">        &#125;);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>所以还是得改改代码。说实话，面向对象虽然我都理解，但就是写不出，不知道是咋回事，所以也是参考了别人写的代码。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">var Animate = function(oElement, options, callback)&#123;this.init.apply(this, arguments)&#125;;</div><div class="line">    Animate.prototype = &#123;</div><div class="line">        init: function(oElement, options, callback)&#123;</div><div class="line">            var oThis = this;</div><div class="line">            this.options = options;</div><div class="line">            this.callback = callback;</div><div class="line">            this.oElement = typeof oElement === &apos;string&apos;?document.getElementById(oElement) : oElement;</div><div class="line">            clearInterval(this.timer);</div><div class="line">            this.timer = setInterval(function()&#123;</div><div class="line">                oThis.doMove();</div><div class="line">            &#125;, 30)</div><div class="line">        &#125;,</div><div class="line">        css: function(attr, value)&#123;</div><div class="line">            if(arguments.length == 1)&#123;</div><div class="line">                return parseFloat(this.oElement.currentStyle? this.oElement.currentStyle[attr]: getComputedStyle(this.oElement, null)[attr]);</div><div class="line">            &#125;else if(arguments.length === 2)&#123;</div><div class="line">                attr === &apos;opacity&apos; ? (this.oElement.style.filter ==  &apos;alpha(opacity=&apos; + value +&apos;)&apos;,this.oElement.style.opacity =value/100) : this.oElement.style[attr] = value + &quot;px&quot;;</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        doMove: function()&#123;</div><div class="line">            var opt = this.options;</div><div class="line">            var bComplete = true;</div><div class="line">            for(var p in opt)&#123;</div><div class="line">                var iCur = p === &apos;opacity&apos; ? parseInt(this.css(p).toFixed(2) * 100) : this.css(p);</div><div class="line">                var iSpeed = (opt[p] - iCur) / 8;</div><div class="line">                iSpeed = iSpeed &gt; 0 ? Math.ceil(iSpeed) : Math.floor(iSpeed);</div><div class="line">                opt[p] == iCur || (bComplete = false, this.css(p, iCur + iSpeed));</div><div class="line">            &#125;</div><div class="line">            bComplete &amp;&amp; (clearInterval(this.timer), this.callback &amp;&amp; this.callback.call(this))</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    window.onload = function()&#123;</div><div class="line">        var dialog = document.getElementById(&quot;dialog&quot;);</div><div class="line">        var jclick = document.querySelector(&quot;.jclick&quot;);</div><div class="line">        var aData = [</div><div class="line">            &#123;left:10,opacity:10&#125;,</div><div class="line">            &#123;left:1000,opacity:100,top:10&#125;,</div><div class="line">        ];</div><div class="line">        jclick.onclick = function()&#123;</div><div class="line"></div><div class="line">            var i = -1;</div><div class="line">            function begin()&#123;</div><div class="line">                i&lt; aData.length ?　i++ : i--;</div><div class="line">                var obj = new Animate(dialog, aData[i], begin);</div><div class="line">                if(i == aData.length || i &lt; 0) &#123;</div><div class="line">                    clearInterval(obj.timer);</div><div class="line">                    return;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            begin();</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<h3 id="正则表达式-1"><a href="#正则表达式-1" class="headerlink" title="正则表达式"></a>正则表达式</h3><p>写一个正则匹配表达式匹配包含数字和字母且在8-16位。其实就是匹配密码的合法输入。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> reg = <span class="regexp">/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]&#123;8,16&#125;/</span>;</div></pre></td></tr></table></figure></p>
<p>这段正则的含义：<br>^ 匹配开头<br>$ 匹配到结尾<br>[0-9a-zA-Z] 匹配0-9,a-z,A-Z中任意字符<br>{8, 16} 至少8位，至多16位</p>
<ul>
<li>至少出现一次<br>(?!…) 负向零宽断言(真难理解)，否定顺序环视，也就是说右边必须在[0-9]后必须出现非[0-9]的结构</li>
</ul>
<p>上面判断的条件拆分为</p>
<ol>
<li>必须为数字和字母</li>
<li>不能全是数字 (第一个负向零宽断言)</li>
<li>不能全是字母 (第二个负向零宽断言)</li>
</ol>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>通过这次笔试，发现自己在基础的JS代码上还是不够熟练，特别是写段代码的时候。想要写出一手健壮的JS代码还是很难的。<br>通过这次笔试还需要</p>
<ul>
<li>把MDN的JavaScript面向对象再过一遍</li>
<li>再看看设计模式，据说JavaScript设计模式与开发实践不错</li>
<li>从小demo入手，用面向对象改写。</li>
<li>《JavaScript高级程序设计三》确实是好书。面试题都是现成的！是该好好看下，Ajax这块尤为重要</li>
<li>webkit技术内幕</li>
</ul>
<p>错过了秋招，除了这次笔试题之外，也了解到一些加分项：</p>
<ul>
<li>Node.js</li>
<li><code>MV*</code>框架</li>
</ul>
<p>要学的太多了，加油吧，小伙子。机会很多，可需要能力才能驾驭机遇。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/06/基于MVC的JavaScript-Web富应用开发/" itemprop="url">
                  基于MVC的JavaScript Web富应用开发
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-06T17:21:19+08:00" content="2016-11-06">
              2016-11-06
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/11/06/基于MVC的JavaScript-Web富应用开发/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/06/基于MVC的JavaScript-Web富应用开发/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><em>不看书就觉得自己学得不充实。只是希望自己在看书摘录笔记的时候别忘了留点时间思考。</em></p>
<h2 id="MVC和类"><a href="#MVC和类" class="headerlink" title="MVC和类"></a>MVC和类</h2><ul>
<li>数据(模型)</li>
<li>展现层(视图)</li>
<li>控制层(控制器)</li>
</ul>
<ol>
<li>用户与应用产生交互</li>
<li>控制器的事件处理器被触发</li>
<li>控制器从模型中请求数据，并将其交给视图</li>
<li>视图将数据呈现给用户</li>
</ol>
<h3 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h3><p>存放引用的所有数据对象，模型只需包含数据及其直接和这些数据关联的逻辑。任何事件处理代码、视图模板以及和模型无关的逻辑都应该被隔离在模型外。</p>
<p>它控制器从服务器中抓取数据或创建新的记录时，它就将数据包装成模型实例。</p>
<h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><p>视图层是呈现给用户。</p>
<h3 id="控制器"><a href="#控制器" class="headerlink" title="控制器"></a>控制器</h3><p>控制器从视图中获得事件和输入，对它们进行处理并更新视图。当页面加载时，控制器会给视图添加事件监听，</p>
<h2 id="向模块化进军"><a href="#向模块化进军" class="headerlink" title="向模块化进军"></a>向模块化进军</h2><h3 id="函数调用"><a href="#函数调用" class="headerlink" title="函数调用"></a>函数调用</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> clicky =&#123;</div><div class="line">    wasClicked: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="comment">//...</span></div><div class="line">    &#125;,</div><div class="line">    addListeners: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">        $(<span class="string">'clicky'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">            self.wasClicked();</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">clicky.addListeners();</div></pre></td></tr></table></figure>
<p>利用apply<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> proxy = <span class="function"><span class="keyword">function</span>(<span class="params">func, thisObject</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> func.apply(thisObject, <span class="built_in">arguments</span>);</div><div class="line">    &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> clicky =&#123;</div><div class="line">    wasClicked: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="comment">//...</span></div><div class="line">    &#125;,</div><div class="line">    addListeners: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        $(<span class="string">'clicky'</span>).click(proxy(<span class="keyword">this</span>.wasClicked, <span class="keyword">this</span>));</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>jQuery实现了该机制<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">".clicky"</span>).click($&gt;proxy(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">/*...*/</span>&#125;, <span class="keyword">this</span>));</div></pre></td></tr></table></figure></p>
<h2 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h2><h3 id="事件库"><a href="#事件库" class="headerlink" title="事件库"></a>事件库</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">jQuery(<span class="built_in">window</span>).bind(<span class="string">"load"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    $(<span class="string">"#demo"</span>).submit(checkform);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 在DOM加载完毕时触发这个事件，此时的图片和样式表可能还未加载完毕。</span></div><div class="line">jQuery(<span class="function"><span class="keyword">function</span>(<span class="params">$</span>)</span>&#123;</div><div class="line">    $(<span class="string">"#demo"</span>).submit(checkform);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="事件委托"><a href="#事件委托" class="headerlink" title="事件委托"></a>事件委托</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">"ul"</span>).delegate(<span class="string">"li"</span>, <span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">/**/</span>&#125;)</div></pre></td></tr></table></figure>
<h3 id="自定义事件"><a href="#自定义事件" class="headerlink" title="自定义事件"></a>自定义事件</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> PubSub = &#123;</div><div class="line">    subscribe: <span class="function"><span class="keyword">function</span>(<span class="params">ev, callback</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> calls = <span class="keyword">this</span>._callbacks || (<span class="keyword">this</span>._callbacks = &#123;&#125;);</div><div class="line">        (<span class="keyword">this</span>._callbacks[ev] || (<span class="keyword">this</span>._callbacks[ev] = [])).push(callback);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">    &#125;,</div><div class="line"></div><div class="line">    publish: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="comment">//转换为真正的数组</span></div><div class="line">        <span class="keyword">var</span> args = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>, <span class="number">0</span>);</div><div class="line">        <span class="comment">//取出第一个参数，事件名称</span></div><div class="line">        <span class="keyword">var</span> ev = args.shift();</div><div class="line"></div><div class="line">        <span class="keyword">var</span> list, calls, i, l;</div><div class="line">        <span class="keyword">if</span>(!(calls = <span class="keyword">this</span>._callbacks)) <span class="keyword">return</span>  <span class="keyword">this</span>;</div><div class="line">        <span class="keyword">if</span>(!(lists = <span class="keyword">this</span>._callbacks[ev])) <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>, l = list.length; i &lt; l; i++)&#123;</div><div class="line">            list[i].apply(<span class="keyword">this</span>, args);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"></div><div class="line">PubSub.subscribe(<span class="string">'ww'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"ww"</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">PubSub.publish(<span class="string">"ww"</span>); <span class="comment">// ww;</span></div></pre></td></tr></table></figure>
<h2 id="模型和数据"><a href="#模型和数据" class="headerlink" title="模型和数据"></a>模型和数据</h2><h3 id="原型继承"><a href="#原型继承" class="headerlink" title="原型继承"></a>原型继承</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="built_in">Object</span>.create !== <span class="string">'function'</span>)&#123;</div><div class="line">    <span class="built_in">Object</span>.create = <span class="function"><span class="keyword">function</span>(<span class="params">o</span>)</span>&#123;</div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>)</span>&#123;&#125;;</div><div class="line">        F.prototype = o;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> F();</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="添加ORM属性"><a href="#添加ORM属性" class="headerlink" title="添加ORM属性"></a>添加ORM属性</h3><p>ORM(object-relational mapper)构建对象映射，用于实现面向对象编程语言里不同类型系统的数据之间的转换。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Model = &#123;</div><div class="line">    inherit: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">    created: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">    prototype: &#123;</div><div class="line">        init: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">    &#125;,</div><div class="line">    create: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> object = <span class="built_in">Object</span>.create(<span class="keyword">this</span>);</div><div class="line">        object.parent = <span class="keyword">this</span>;</div><div class="line">        object.prototype = object.fn = <span class="built_in">Object</span>.create(<span class="keyword">this</span>.prototype);</div><div class="line"></div><div class="line">        object.created();</div><div class="line">        <span class="keyword">this</span>.inherited(object);</div><div class="line">        <span class="keyword">return</span> object;</div><div class="line">    &#125;,</div><div class="line">    init: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> instance = <span class="built_in">Object</span>.create(<span class="keyword">this</span>.prototype);</div><div class="line">        instance.parent = <span class="keyword">this</span>;</div><div class="line">        instance.init.apply(instance, <span class="built_in">arguments</span>);</div><div class="line">        <span class="keyword">return</span> instance;</div><div class="line">    &#125;,</div><div class="line">    extend: <span class="function"><span class="keyword">function</span>(<span class="params">o</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> extended = o.extended;</div><div class="line">        jQuery.extend(<span class="keyword">this</span>, o);</div><div class="line">        <span class="keyword">if</span>(extended) extended(<span class="keyword">this</span>);</div><div class="line">    &#125;,</div><div class="line">    include: <span class="function"><span class="keyword">function</span>(<span class="params">o</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> included = o.included;</div><div class="line">        jQuery.extend(<span class="keyword">this</span>.prototype, o);</div><div class="line">        <span class="keyword">if</span>(included) included(<span class="keyword">this</span>);</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h3 id="持久化记录"><a href="#持久化记录" class="headerlink" title="持久化记录"></a>持久化记录</h3><p>将引用保存至新创建的实例中以便任何时候都能访问它。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//用来保存资源的对象</span></div><div class="line">Model.records = &#123;&#125;;</div><div class="line"></div><div class="line">Model.include(&#123;</div><div class="line">    newRecord: <span class="literal">true</span>,</div><div class="line"></div><div class="line">    create: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">this</span>.newRecord = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">this</span>.parent.records[<span class="keyword">this</span>.id] = <span class="keyword">this</span>;</div><div class="line">    &#125;,</div><div class="line">    destory: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">delete</span> <span class="keyword">this</span>.parent.records[<span class="keyword">this</span>.id];</div><div class="line">    &#125;,</div><div class="line">    update: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">this</span>.parent.records[<span class="keyword">this</span>.id] = <span class="keyword">this</span>;<span class="comment">//更新对象引用</span></div><div class="line">    &#125;,</div><div class="line">    save: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="comment">//将对象存入hash记录中，保持一个引用指向它</span></div><div class="line">        <span class="keyword">this</span>.newRecord? <span class="keyword">this</span>.create() : <span class="keyword">this</span>.update();</div><div class="line">    &#125;,</div><div class="line">    find: <span class="function"><span class="keyword">function</span>(<span class="params">id</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.records[id] || <span class="built_in">Error</span>(<span class="string">"Unknown record"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/06/阅读一起学Node/" itemprop="url">
                  阅读一起学Node
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-06T10:14:57+08:00" content="2016-11-06">
              2016-11-06
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Node/" itemprop="url" rel="index">
                    <span itemprop="name">Node</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/11/06/阅读一起学Node/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/06/阅读一起学Node/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Node-js环境搭建"><a href="#Node-js环境搭建" class="headerlink" title="Node.js环境搭建"></a>Node.js环境搭建</h2><h3 id="安装-Node-js"><a href="#安装-Node-js" class="headerlink" title="安装 Node.js"></a>安装 Node.js</h3><blockquote>
<p>小提示：从 <a href="http://node.green" target="_blank" rel="external">http://node.green</a> 上可以看到 Node.js 各个版本对 ES6 的支持情况。</p>
</blockquote>
<h4 id="n-和-nvm"><a href="#n-和-nvm" class="headerlink" title="n 和 nvm"></a>n 和 nvm</h4><p>通常我们使用稳定的 LTS 版本的 Node.js 即可，但有的情况下我们又想尝试一下新的特性，我们总不能来回安装不同版本的 Node.js 吧，这个时候我们就需要 n 或者 nvm 了。</p>
<p>nvm:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.29.0/install.sh | bash</div></pre></td></tr></table></figure></p>
<p>切换版本时，曾经在全局安装的各种 node 模块们全都需要重新安装，因为全局模块被安装在每个 node 版本自己的沙箱中，因此它们和老版本的 node 一起被埋葬了。</p>
<ul>
<li>nvm 不支持 Windows。</li>
</ul>
<p>n:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g n</div></pre></td></tr></table></figure></p>
<p>在安装的时候，n 会先将指定版本的 node 存储下来，然后将其复制到我们熟知的路径 /usr/local/bin，非常简单明了。</p>
<h4 id="nrm"><a href="#nrm" class="headerlink" title="nrm"></a>nrm</h4><p>nrm 是一个管理 npm 源的工具。<br>通常我们会把 gem 源切到国内的淘宝镜像，这样在安装和更新一些包的时候比较快。nrm 同理，用来切换官方 npm 源和国内的 npm 源<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//显示npm</div><div class="line">nrm ls</div><div class="line"></div><div class="line">//切换到cnpm,淘宝镜像，下载包会快些，如果安装过的话</div><div class="line">nrm use cnpm</div></pre></td></tr></table></figure></p>
<h3 id="MongoDB-的安装与使用"><a href="#MongoDB-的安装与使用" class="headerlink" title="MongoDB 的安装与使用"></a>MongoDB 的安装与使用</h3><h4 id="Robomongo-和-MongoChef"><a href="#Robomongo-和-MongoChef" class="headerlink" title="Robomongo 和 MongoChef"></a>Robomongo 和 MongoChef</h4><p>Robomongo 是一个基于 Shell 的跨平台开源 MongoDB 可视化管理工具，支持 Windows、Linux 和 Mac，嵌入了 JavaScript 引擎和 MongoDB mongo，只要你会使用 mongo shell，你就会使用 Robomongo，它还提了供语法高亮、自动补全、差别视图等。</p>
<blockquote>
<p>小提示: MongoChef 相较于 Robomongo 更强大一些，但 Robomongo 比较轻量也能满足大部分的常规需求。</p>
</blockquote>
<p>我安装了<code>Robomongo</code>，需要先创建一个js文件执行，alt+Enter 执行命令。（windows）</p>
<h2 id="Node知识点"><a href="#Node知识点" class="headerlink" title="Node知识点"></a>Node知识点</h2><h3 id="从require到AMD和CMD"><a href="#从require到AMD和CMD" class="headerlink" title="从require到AMD和CMD"></a>从require到AMD和CMD</h3><p>在node.js中，采用的是CommonJS的规范实现，通过全局方法require()引入模块<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var a = require(&quot;http&quot;);</div></pre></td></tr></table></figure></p>
<p>这种一种同步机制，必须加载完模块后才能执行后面语句。因为是在服务器环境下运行，所以要加载的模块就是读取磁盘的速度，所以速度快到可以忽略不计。</p>
<p>但这种方式不使用浏览器，这主要是由于同步加载带来的弊端：</p>
<ul>
<li>必须依赖于加载完的模块后才能执行，加载时间长</li>
<li>当文件过大时出现客户端假死状态</li>
</ul>
<p>对于浏览器而言只能采用异步加载方式，即AMD(“Asynchronous Module Definition”)。<br>采用异步方式加载模块，模块的加载不影响它后面语句的运行。所有依赖这个模块的语句，都定义在一个回调函数中，等到加载完成之后，这个回调函数才会运行。</p>
<p>巧的是，AMD也采用require()语句加载模块。但它要求有两个参数。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">require([module], callback);</div></pre></td></tr></table></figure></p>
<p>第一个参数[module]，是一个数组，里面的成员就是要加载的模块；第二个参数callback，则是加载成功之后的回调函数。如果将前面的代码改写成AMD形式，就是下面这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">require([&apos;math&apos;], function (math) &#123;</div><div class="line">　　　　math.add(2, 3);</div><div class="line">　　&#125;);</div></pre></td></tr></table></figure></p>
<p>主要有两个Javascript库实现了AMD规范：<code>require.js</code>和<code>curl.js</code>。</p>
<h3 id="require-js的用法"><a href="#require-js的用法" class="headerlink" title="require.js的用法"></a>require.js的用法</h3><p>require.js解决两个问题</p>
<ul>
<li>实现js文件的异步加载，避免网页失去响应；</li>
<li>管理模块之间的依赖性，便于代码的编写和维护。</li>
</ul>
<h4 id="require的加载"><a href="#require的加载" class="headerlink" title="require的加载"></a>require的加载</h4><p><a href="http://requirejs.org/docs/download.html" target="_blank" rel="external">官网</a>下载最新版本，将该代码放置于<code>body</code>底部<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">　&lt;script src=&quot;js/require.js&quot;&gt;&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p>然后加载自己的代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;js/require.js&quot; data-main=&quot;js/main&quot;&gt;&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p><code>data-main</code>属性的作用是，指定网页程序的主模块。在上例中，就是js目录下面的main.js，这个文件会第一个被require.js加载。由于require.js默认的文件后缀名是js，所以可以把main.js简写成main。</p>
<h4 id="主模块的写法"><a href="#主模块的写法" class="headerlink" title="主模块的写法"></a>主模块的写法</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// main.js</span></div><div class="line">　　<span class="built_in">require</span>([<span class="string">'moduleA'</span>, <span class="string">'moduleB'</span>, <span class="string">'moduleC'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">moduleA, moduleB, moduleC</span>)</span>&#123;</div><div class="line">　　　　<span class="comment">// some code here</span></div><div class="line">　　&#125;);</div><div class="line"><span class="comment">//假如加载juqery,underscore,backbone3个模块</span></div><div class="line"><span class="built_in">require</span>([<span class="string">'jquery'</span>, <span class="string">'underscore'</span>, <span class="string">'backbone'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">$, _, Backbone</span>)</span>&#123;</div><div class="line">　　　　<span class="comment">// some code here</span></div><div class="line">　　&#125;);</div></pre></td></tr></table></figure>
<h4 id="模块的加载"><a href="#模块的加载" class="headerlink" title="模块的加载"></a>模块的加载</h4><p>主模块的依赖模块是[‘jquery’, ‘underscore’, ‘backbone’]。默认情况下，require.js假定这三个模块与main.js在同一个目录，文件名分别为jquery.js，underscore.js和backbone.js，然后自动加载。<br>使用require.config()方法，我们可以对模块的加载行为进行自定义。require.config()就写在主模块（main.js）的头部。参数就是一个对象，这个对象的paths属性指定各个模块的加载路径。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>.config(&#123;</div><div class="line">　　　　paths: &#123;</div><div class="line">　　　　　　<span class="string">"jquery"</span>: <span class="string">"jquery.min"</span>,</div><div class="line">　　　　　　<span class="string">"underscore"</span>: <span class="string">"underscore.min"</span>,</div><div class="line">　　　　　　<span class="string">"backbone"</span>: <span class="string">"backbone.min"</span></div><div class="line">　　　　&#125;</div><div class="line">　　&#125;);</div></pre></td></tr></table></figure>
<p>如果这些模块在其他目录，比如js/lib目录，则有两种写法。一种是逐一指定路径。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">　require.config(&#123;</div><div class="line">　　　　paths: &#123;</div><div class="line">　　　　　　&quot;jquery&quot;: &quot;lib/jquery.min&quot;,</div><div class="line">　　　　　　&quot;underscore&quot;: &quot;lib/underscore.min&quot;,</div><div class="line">　　　　　　&quot;backbone&quot;: &quot;lib/backbone.min&quot;</div><div class="line">　　　　&#125;</div><div class="line">　　&#125;);</div></pre></td></tr></table></figure></p>
<p>另一种则是直接改变基目录（baseUrl）。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">require.config(&#123;</div><div class="line">　　　　baseUrl: &quot;js/lib&quot;,</div><div class="line">　　　　paths: &#123;</div><div class="line">            //假如jquery在另外一台主机上</div><div class="line">　　　　　　&quot;jquery&quot;: &quot;https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min&quot;,</div><div class="line">　　　　　　&quot;underscore&quot;: &quot;underscore.min&quot;,</div><div class="line">　　　　　　&quot;backbone&quot;: &quot;backbone.min&quot;</div><div class="line">　　　　&#125;</div><div class="line">　　&#125;);</div></pre></td></tr></table></figure></p>
<h3 id="AMD模块的写法"><a href="#AMD模块的写法" class="headerlink" title="AMD模块的写法"></a>AMD模块的写法</h3><p>require.js加载的模块，采用AMD规范。也就是说，模块必须按照AMD的规定来写。<br>是模块必须采用特定的define()函数来定义。如果一个模块不依赖其他模块，那么可以直接定义在define()函数之中。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// math.js</span></div><div class="line">　　define(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</div><div class="line">　　　　<span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span> (<span class="params">x,y</span>)</span>&#123;</div><div class="line">　　　　　　<span class="keyword">return</span> x+y;</div><div class="line">　　　　&#125;;</div><div class="line">　　　　<span class="keyword">return</span> &#123;</div><div class="line">　　　　　　add: add</div><div class="line">　　　　&#125;;</div><div class="line">　　&#125;);</div><div class="line"></div><div class="line"><span class="comment">//-----加载方式</span></div><div class="line">　<span class="comment">// main.js</span></div><div class="line">　　<span class="built_in">require</span>([<span class="string">'math'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">math</span>)</span>&#123;</div><div class="line">　　　　alert(math.add(<span class="number">1</span>,<span class="number">1</span>));</div><div class="line">　　&#125;);</div></pre></td></tr></table></figure></p>
<p>如果这个模块还依赖其他模块，那么define()函数的第一个参数，必须是一个数组，指明该模块的依赖性。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">　define([&apos;myLib&apos;], function(myLib)&#123;</div><div class="line">　　　　function foo()&#123;</div><div class="line">　　　　　　myLib.doSomething();</div><div class="line">　　　　&#125;</div><div class="line">　　　　return &#123;</div><div class="line">　　　　　　foo : foo</div><div class="line">　　　　&#125;;</div><div class="line">　　&#125;);</div></pre></td></tr></table></figure></p>
<p><a href="http://www.ruanyifeng.com/blog/2015/05/require.html" target="_blank" rel="external">require.js源码</a></p>
<h3 id="exports-和-module-exports"><a href="#exports-和-module-exports" class="headerlink" title="exports 和 module.exports"></a>exports 和 module.exports</h3><p>这个例子倒是很好，加深了我对引用赋值的理解<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = &#123;name: <span class="number">1</span>&#125;;</div><div class="line"><span class="keyword">var</span> b = a;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(a);</div><div class="line"><span class="built_in">console</span>.log(b);</div><div class="line"></div><div class="line">b.name = <span class="number">2</span>;</div><div class="line"><span class="built_in">console</span>.log(a);</div><div class="line"><span class="built_in">console</span>.log(b);</div><div class="line"></div><div class="line"><span class="keyword">var</span> b = &#123;name: <span class="number">3</span>&#125;;</div><div class="line"><span class="built_in">console</span>.log(a);</div><div class="line"><span class="built_in">console</span>.log(b);</div></pre></td></tr></table></figure></p>
<p>运行结果如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123; name: <span class="number">1</span> &#125;</div><div class="line">&#123; name: <span class="number">1</span> &#125;</div><div class="line">&#123; name: <span class="number">2</span> &#125;</div><div class="line">&#123; name: <span class="number">2</span> &#125;</div><div class="line">&#123; name: <span class="number">2</span> &#125;</div><div class="line">&#123; name: <span class="number">3</span> &#125;</div></pre></td></tr></table></figure></p>
<p>a 是一个对象，b 是对 a 的引用，即 a 和 b 指向同一块内存，所以前两个输出一样。当对 b 作修改时，即 a 和 b 指向同一块内存地址的内容发生了改变，所以 a 也会体现出来，所以第三四个输出一样。当 b 被覆盖时，b 指向了一块新的内存，a 还是指向原来的内存，所以最后两个输出不一样。</p>
<ol>
<li>module.exports 初始值为一个空对象 {}</li>
<li>exports 是指向的 module.exports 的引用</li>
<li>require() 返回的是 module.exports 而不是 exports</li>
</ol>
<p>我们经常看到这样的写法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">exports = module.exports = &#123;...&#125;</div></pre></td></tr></table></figure></p>
<p>原理很简单：module.exports 指向新的对象时，exports 断开了与 module.exports 的引用，那么通过 exports = module.exports 让 exports 重新指向 module.exports。</p>
<h3 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h3><p>这是个大话题，主要是用来控制异步流程的，改善回调函数。</p>
<ul>
<li>resolve(成功时，调用onFulfilled)</li>
<li>reject(失败时，调用onRejected)</li>
<li>pending(promise对象刚被创建后的初始化状态)<br><a href="http://es6.ruanyifeng.com/#docs/promise" target="_blank" rel="external">ES6入门</a></li>
</ul>
<h3 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h3><p>必填字段</p>
<ul>
<li>name</li>
<li>version</li>
</ul>
<h3 id="npm-install"><a href="#npm-install" class="headerlink" title="npm install"></a>npm install</h3><ol>
<li><code>npm i express --save/npm i express -S</code> (安装 express，同时将 “express”: “^4.14.0” 写入 dependencies )</li>
<li><code>npm i express --save-dev/npm i express -D</code> (安装 express，同时将 “express”: “^4.14.0” 写入 devDependencies )</li>
<li><code>npm i express --save --save-exact</code> (安装 express，同时将 “express”: “4.14.0” 写入 dependencies )</li>
</ol>
<p>第三种方式将固定版本号写入 dependencies，建议线上的 Node.js 应用都采取这种锁定版本号的方式，因为你不可能保证第三方模块下个小版本是没有验证 bug 的，即使是很流行的模块。</p>
<h3 id="npm-shrinkwrap"><a href="#npm-shrinkwrap" class="headerlink" title="npm shrinkwrap"></a>npm shrinkwrap</h3><p>了彻底锁定依赖的版本，让你的应用在任何机器上安装的都是同样版本的模块（不管嵌套多少层），通过运行 npm shrinkwrap，会在当前目录下产生一个 npm-shrinkwrap.json，里面包含了通过 node_modules 计算出的模块的依赖树及版本。</p>
<p><em>只要目录下有 npm-shrinkwrap.json 则运行 npm install 的时候会优先使用 npm-shrinkwrap.json 进行安装，没有则使用 package.json 进行安装。</em></p>
<h2 id="express"><a href="#express" class="headerlink" title="express"></a>express</h2><h3 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h3><p>req 包含了请求来的相关信息，res 则用来返回该请求的响应</p>
<ul>
<li><code>req.query</code>: 解析后的 url 中的 querystring，如 <code>?name=haha</code>，req.query 的值为<code>{name: &#39;haha&#39;}</code></li>
<li><code>req.params</code>: 解析 url 中的占位符，如 <code>/:name</code>，访问 <code>/haha</code>，req.params 的值为 <code>{name: &#39;haha&#39;}</code></li>
<li><code>req.body</code>: 解析后请求体，需使用相关的模块，如 body-parser，请求体为 <code>{&quot;name&quot;: &quot;haha&quot;}</code>，则 req.body 为 <code>{name: &#39;haha&#39;}</code></li>
</ul>
<h3 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h3><p>通过调用 <code>res.render</code> 函数渲染 ejs 模板.<br><code>res.render</code> 的作用就是将模板和数据结合生成 html，同时设置响应头中的 <code>Content-Type: text/html</code>，告诉浏览器我返回的是 html，不是纯文本，要按 html 展示。</p>
<ol>
<li><code>&lt;% code %&gt;</code>：运行 JavaScript 代码，不输出</li>
<li><code>&lt;%= code %&gt;</code>：显示转义后的 HTML内容</li>
<li><code>&lt;%- code %&gt;</code>：显示原始 HTML 内容</li>
</ol>
<blockquote>
<p>注意：&lt;%= code %&gt; 和 &lt;%- code %&gt; 都可以是 JavaScript 表达式生成的字符串，当变量 code 为普通字符串时，两者没有区别。当 code 比如为 </p><h1>hello</h1> 这种字符串时，&lt;%= code %&gt; 会原样输出 <h1>hello</h1>，而 &lt;%- code %&gt; 则会显示 H1 大的 hello 字符串。<p></p>
</blockquote>
<p>模板拆分<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;%- include(<span class="string">'header'</span>) %&gt;</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">name.toUpperCase</span>() %&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></div><div class="line">  &lt;p&gt;hello, <span class="xml"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">name</span> %&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></div><div class="line">&lt;%- include(<span class="string">'footer'</span>) %&gt;</div></pre></td></tr></table></figure></p>
<h3 id="express-中间件"><a href="#express-中间件" class="headerlink" title="express 中间件"></a>express 中间件</h3><p><code>express</code>中的中间件<code>middleware</code>就是用来处理请求的，当一个中间件处理完，可以通过调用 <code>next()</code> 传递给下一个中间件，如果没有调用 <code>next()</code>，则请求不会往下传递，如内置的 <code>res.render</code> 其实就是渲染完 html 直接返回给客户端，没有调用 <code>next()</code>，从而没有传递给下一个中间件。</p>
<h3 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h3><ol>
<li><code>models</code>: 存放操作数据库的文件</li>
<li><code>public</code>: 存放静态文件文件，如样式、图片等</li>
<li><code>routes</code>: 存放路由文件</li>
<li><code>views</code>: 存放模板文件</li>
<li><code>index</code>.js: 程序主文件</li>
<li><code>package.json</code>: 存储项目名、描述、作者、依赖等等信息</li>
</ol>
<h4 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h4><p>不管是小项目还是大项目，将配置与代码分离是一个非常好的做法。我们通常将配置写到一个配置文件里，如 config.js 或 config.json ，并放到项目的根目录下。但通常我们都会有许多环境，如本地开发环境、测试环境和线上环境等，不同的环境的配置不同，我们不可能每次部署时都要去修改引用 config.test.js 或者 config.production.js。config-lite 模块正是你需要的。</p>
<h4 id="config-lite"><a href="#config-lite" class="headerlink" title="config-lite"></a>config-lite</h4><p>config-lite 是一个轻量的读取配置文件的模块。config-lite 会根据环境变量（<code>NODE_ENV</code>）的不同从当前执行进程目录下的 config 目录加载不同的配置文件。如果不设置 NODE_ENV，则读取默认的 default 配置文件，如果设置了 NODE_ENV，则会合并指定的配置文件和 default 配置文件作为配置，config-lite 支持 .js、.json、.node、.yml、.yaml 后缀的文件。</p>
<p>总之，会根据你的<code>NODE_ENV=xxx node app</code> 根据<code>xxx</code>来查找文件目录里面所有的文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  port: <span class="number">3000</span>,</div><div class="line">  session: &#123;</div><div class="line">    secret: <span class="string">'myblog'</span>,</div><div class="line">    key: <span class="string">'myblog'</span>,</div><div class="line">    maxAge: <span class="number">2592000000</span></div><div class="line">  &#125;,</div><div class="line">  mongodb: <span class="string">'mongodb://localhost:27017/nblog'</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><code>mongodb</code>: <code>mongodb</code> 的地址，nblog 为 db 名</p>
<h3 id="RESTful-API-设计指南"><a href="#RESTful-API-设计指南" class="headerlink" title="RESTful API 设计指南"></a>RESTful API 设计指南</h3><p>这里主要介绍的是每个路由地址的跳转地址该如何设定（对此阶段并不要紧）</p>
<h3 id="会话"><a href="#会话" class="headerlink" title="会话"></a>会话</h3><p>####cookie </p>
<ul>
<li>服务器向客户端发送 cookie。<ul>
<li>通常使用 HTTP 协议规定的 set-cookie 头操作。</li>
<li>规范规定 cookie 的格式为 name = value 格式，且必须包含这部分。</li>
</ul>
</li>
<li>浏览器将 cookie 保存。</li>
<li>每次请求浏览器都会将 cookie 发向服务器。<br>每个域下最多存放50个cookie.一般来说，一个cookie不超过4KB，多余的会被清除。</li>
</ul>
<p>cookie 虽然很方便，但是使用 cookie 有一个很大的弊端，cookie 中的所有数据在客户端就可以被修改，数据非常容易被伪造，那么一些重要的数据就不能存放在 cookie 中了，而且如果 cookie 中数据字段太多会影响传输效率。为了解决这些问题，就产生了 session，session 中的数据是保留在服务器端的。</p>
<p>####session<br>session 的运作通过一个 <code>session_id</code> 来进行。<code>session_id</code> 通常是存放在客户端的 cookie 中，比如在 express 中，默认是 <code>connect.sid</code> 这个字段，当请求到来时，服务端检查 cookie 中保存的 <code>session_id</code> 并通过这个 <code>session_id</code> 与服务器端的 session data 关联起来，进行数据的保存和修改。</p>
<p>session 可以存放在 1）内存、2）cookie本身、3）redis 或 memcached 等缓存中，或者4）数据库中。线上来说，缓存的方案比较常见，存数据库的话，查询效率相比前三者都太低，不推荐；cookie session 有安全性问题，下面会提到。</p>
<p>初学者容易犯的一个错误是，忘记了 session_id 在 cookie 中的存储方式是 session cookie。即，当用户一关闭浏览器，浏览器 cookie 中的 session_id 字段就会消失。</p>
<h3 id="webcomponent"><a href="#webcomponent" class="headerlink" title="webcomponent"></a>webcomponent</h3><p>在调用 <code>res.render</code> 的时候，express 合并（merge）了 3 处的结果后传入要渲染的模板，<code>res.render</code> 传入的对象&gt; <code>res.locals</code> 对象 &gt; <code>app.locals</code> 对象，所以 <code>app.locals</code> 和 <code>res.locals</code> 几乎没有区别，都用来渲染模板，使用上的区别在于：<code>app.locals</code> 上通常挂载常量信息（如博客名、描述、作者信息），<code>res.locals</code> 上通常挂载变量信息，即每次请求可能的值都不一样（如请求者信息，<code>res.locals.user = req.session.user</code>）。</p>
<h3 id="Mongolass"><a href="#Mongolass" class="headerlink" title="Mongolass"></a>Mongolass</h3><p>更详细的错误信息提醒。</p>
<h3 id="用户模型设计"><a href="#用户模型设计" class="headerlink" title="用户模型设计"></a>用户模型设计</h3><blockquote>
<p>小提示：Mongolass 中的 model 你可以认为相当于 mongodb 中的 collection，只不过添加了插件的功能。</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/24/Node学习笔记/" itemprop="url">
                  Node学习笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-24T13:33:19+08:00" content="2016-10-24">
              2016-10-24
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/24/Node学习笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/24/Node学习笔记/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>node是采用CMD模块系统，主模块作为程序入口，所有模块在执行中只初始化一次。</p>
<h3 id="从模块到包"><a href="#从模块到包" class="headerlink" title="从模块到包"></a>从模块到包</h3><p>我们已经知道了JS模块的基本单位是单个JS文件，但复杂些的模块往往由多个子模块组成。为了便于管理和使用，我们可以把由多个子模块组成的大模块称做包，并把所有子模块放在同一个目录里。</p>
<blockquote>
<ul>
<li>/home/user/lib/<ul>
<li>cat/<br>  head.js<br>  body.js<br>  main.js</li>
</ul>
</li>
</ul>
</blockquote>
<p>假设这是文件目录，<code>main.js</code>作为入口模块，其内容如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">var head = require(&quot;head&quot;);</div><div class="line">var body = require(&quot;body&quot;);</div><div class="line"></div><div class="line">exports.create = function(name)&#123;</div><div class="line">    return &#123;</div><div class="line">        name: name,</div><div class="line">        head: head.create(),</div><div class="line">        body: body.create()</div><div class="line">    &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>然后在你需要导入的文件下写<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var cat = require(&apos;/home/user/lib/cat/main&apos;);</div></pre></td></tr></table></figure></p>
<p>这样，该文件就引入了包。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/15/响应式网站初探/" itemprop="url">
                  响应式网站初探
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-15T19:25:33+08:00" content="2016-10-15">
              2016-10-15
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/15/响应式网站初探/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/15/响应式网站初探/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>响应式网站核心理念<br>（这是一种设计理念）</p>
<ul>
<li>flexible grid layout 弹性网格布局</li>
<li>flexible image 弹性图片</li>
<li>media queries 媒体查询</li>
</ul>
<h2 id="css3媒体查询"><a href="#css3媒体查询" class="headerlink" title="css3媒体查询"></a>css3媒体查询</h2><h3 id="逻辑操作符"><a href="#逻辑操作符" class="headerlink" title="逻辑操作符"></a>逻辑操作符</h3><ul>
<li>only 表示仅在媒体查询匹配成功的情况下应用该指定样式。可以通过它选中的样式在老浏览器中不被使用</li>
<li>and 操作符把多个媒体属性集合，当每个属性都为真时，查询结果才为真</li>
<li>not 操作符表示对一条媒体查询取反结果<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@media tv and (min-width: 700px) and (orientation: landscape) &#123; ... &#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>现在，上面媒体查询仅在电视媒体上，可视区域不小于700像素宽度并且是横屏时有效。</p>
<h3 id="逗号分隔列表"><a href="#逗号分隔列表" class="headerlink" title="逗号分隔列表"></a>逗号分隔列表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@media (min-width: 700px), handheld and (orientation: landscape) &#123; ... &#125;</div></pre></td></tr></table></figure>
<p>媒体查询中使用逗号分隔效果等同于 or 逻辑操作符。满足任意条件即可</p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Media_queries" target="_blank" rel="external">MDN CSS媒体查询</a></p>
<h3 id="meta"><a href="#meta" class="headerlink" title="meta"></a>meta</h3><p>如果设置了 name , 它是一个文档级的元数据，将附着在整个页面上。<br>如果设置了 http-equiv , 它是一个编译指令， 即，由服务器提供的来指示页面应如何加载。<br>如果设置了  charset， 即，将对网页使用的字符集作出声明 HTML5<br>如果设置了  itemprop，将定义一个用户自定义的元数据，也因此语义声明，这个定义将对用户代理完全开放。Living Standard 未实现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no&quot; /&gt;</div></pre></td></tr></table></figure></p>
<p>ViewPort <meta>标记用于指定用户是否可以缩放Web页面，如果可以，那么缩放到的最大和最小缩放比例是什么。使用ViewPort <meta>标记还表示文档针对移动设备进行了优化。ViewPort <meta>标记的content值是由指令及其值组成的以逗号分隔的列表。</p>
<p><a href="https://gist.github.com/Jimco/9524062" target="_blank" rel="external">完整的meta预览</a></p>
<p>设置了viewport后还需要关注的是<code>width</code>(视口宽度)<br>移动端中<code>width</code>的不同概念</p>
<ul>
<li>布局视口，用户缩放不可改变，PC的网站在移动端浏览时会先按照PC端的大小进行渲染</li>
<li>可视视口（用户缩放可以改变可视视口，默认宽度为屏幕宽度）</li>
<li>理想视口 是移动端在浏览页面时的最佳视口，为优化手机浏览器而添加的</li>
</ul>
<p>理想视口就是为构建手机浏览器优化的页面而添加.<br>可视视口(visual viewport)–在手机上呈现出来的一个宽度，用户的缩放可以改变可视视口的大小，是不会改变布局视口的大小的；<br>布局视口(layout viewport)–用一个虚拟的960px的宽度把网页先布局出来，大小是不变的；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;ie=edge&quot; /&gt;</div><div class="line">&lt;!-- iE文档兼容性 强制使用以最新的IE浏览器进行渲染--&gt;</div></pre></td></tr></table></figure>
<p>如果是必不可少的图片建议采用img引入，<br>如果只是装饰性的图片可以使用标签的style引入。<br>避免当用户禁用样式时屏蔽了必要的图片</p>
<ul>
<li><p>em<br>相对长度单位，这个单位表示元素的font-size的计算值。如果用在font-size 属性本身，它会继承父元素的font-size。<br>假设当前设置<code>font-size:0</code>， 浏览器会有一个默认的em设置<code>1em = 16px</code>;</p>
</li>
<li><p>rem<br>相对参照物为根元素<code>&lt;html&gt;</code>的<code>font-size</code>大小。</p>
</li>
<li><p>vw<br>视口宽度的 1/100。</p>
</li>
<li><p>px<br>与显示设备相关。<br>对于屏幕显示，通常是一个设备像素（点）的显示。<br>对于打印机和高分辨率的屏幕，一个CSS像素意味着多个设备像素，因此，每英寸的像素的数量保持在96左右。</p>
</li>
</ul>
<h3 id="创建文件"><a href="#创建文件" class="headerlink" title="创建文件"></a>创建文件</h3><ol>
<li>建立404页面（4.4.html）:找不到正确页面，跳转到的页面；替换服务器上默认的错误页页面； </li>
<li>创建robots.txt文件（机器人：给机器看的，给搜索引擎看的）：是搜索引擎访问网站时查看的第一个文件，这个文件告诉引擎什么能查看，什么不能查看；</li>
<li>创建favicon.ico文件：网站的logo，在网站的标签上显示；</li>
<li>创建humans.txt文件（人类：给人看的）：保存网站建设者和一些其他的有用的信息</li>
</ol>
<h3 id="制作过程中遇到的问题："><a href="#制作过程中遇到的问题：" class="headerlink" title="制作过程中遇到的问题："></a>制作过程中遇到的问题：</h3><h4 id="断点的单位"><a href="#断点的单位" class="headerlink" title="断点的单位"></a>断点的单位</h4><p>在媒体查询中，相对单位rem和em的基准高于html，所以与在html中设置的rem大小并不一致！这里的rem或em依然是：1rem=1em=16px，所以800/16=50rem。另外，rem兼容性不如em，故采用兼容性更好的em为媒体查询的断点单位。</p>
<h4 id="line-block-空白符解析会产生间隙"><a href="#line-block-空白符解析会产生间隙" class="headerlink" title="line-block 空白符解析会产生间隙"></a>line-block 空白符解析会产生间隙</h4><p>解决这种问题的方式有以下几种： </p>
<ol>
<li>消除HTML代码中元素间的空白 </li>
<li>设置父元素的font-size:0;（有副作用） </li>
<li>子元素不闭合，浏览器自动补全</li>
<li>子元素设置负边距，不同浏览器间距不一 </li>
<li>设置子元素样式：white-space-collapsing(css4属性，兼容性不好)</li>
</ol>
<h4 id="媒体查询中的像素（em-pxd等）"><a href="#媒体查询中的像素（em-pxd等）" class="headerlink" title="媒体查询中的像素（em,pxd等）"></a>媒体查询中的像素（em,pxd等）</h4><p>媒体查询中设置了<code>px</code>的话是浏览器默认的样式，脱离了css设置的优先级，所以在媒体查询中<code>1em = 16px</code>。</p>
<h4 id="chrome默认字体"><a href="#chrome默认字体" class="headerlink" title="chrome默认字体"></a>chrome默认字体</h4><p>Chrome有一个下限，中文为12px，如果设置<code>font-size=10px;line-heigh=3rem</code>，实为36px，而不是30px。</p>
<h4 id="清除浮动"><a href="#清除浮动" class="headerlink" title="清除浮动"></a>清除浮动</h4><p>清除浮动3种方法—-触发BFC（上下文格式化）即可： 1）给盒子最末尾添加带有clear:both;属性的盒子； 2）给盒子添加overflow:hidden;属性； 3）给盒子添加伪元素的类名.clearfix：after{ content:”.”; height:”0”; visible:hidden: clear:both; }; 最常采用方法： 添加类名.clearfix:before,.clearfix:after{ content:””; display-block:table; } .clearfix:after{ clear:both; }</p>
<p>css3选择器</p>
<p>js控制图片加载</p>
<pre><code>//通过cookie进行设置也可以

srcset
srcset 配合 sizes
picture
svg

浏览器默认行为

&lt;img src=&quot;&quot; alt=&quot;&quot; srcset=&quot;img/480.png 480w, img/800.png 800w&quot; sizes=&quot;100vw&quot; &gt;//

图片尺寸表示100%视口宽度，即使父容器宽度设置为50%，依然会按照视口宽度来进行

图片格式
</code></pre><p>1、gulp-watch：监听文件，如果文件有改动自动执行任务 2、gulp-postcss：与autoprefixer结合，自动给一些css添加前缀 3、gulp-concat：多个文件合并成一个文件 4、gulp-responsive：实现响应式图片插件</p>
<p>margin-top下盒子 和 margin-bottom上盒子会发生叠加，产生浏览器顶端空白崩溃 :before{content:””;display:table}防止叠加</p>
<p><header> <footer> <section> 相当于特殊的section： <nav>导航 <article>文章 html5标签新规定： <b>加粗，吸引人注意，可是没有强调的意思 <em>重点强调的文字 <i>有不同的语态语气，如有反讽的语气</i></em></b></article></nav></section></footer></header></p>
<p>浏览器支持状态<br>use i use usage-table<br><a href="http://gs.statcounter.com/#browser-CN-monthly-201509-201609" target="_blank" rel="external">gs.statcounter.com</a><br>[x5.tencent.com] 腾讯QQ浏览器内核</p>
<p>移动端浏览器测试： 1.如果要真机，去www.umindex.com查看各机型活跃度，针对性购买 2.云测试，www.testin.cn 3.安卓虚拟机模拟器，www.genymotion.net</p>
<p>autoprefixer.github.io(工具转</p>
<p>bitbug.net 将图片转化为icon图标<br>dilingor.io</p>
<p>csshack</p>
<p>broswerhacks </p>
<p>html5shiv</p>
<p>modernizer</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/13/轮播图组件/" itemprop="url">
                  轮播图组件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-13T18:12:16+08:00" content="2016-10-13">
              2016-10-13
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/13/轮播图组件/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/13/轮播图组件/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/11/图片异步加载/" itemprop="url">
                  图片加载的策略
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-11T20:58:59+08:00" content="2016-10-11">
              2016-10-11
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/11/图片异步加载/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/11/图片异步加载/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>懒加载：延迟加载图片或符合某些条件时才加载某些图片。<br>预加载：提前加载图片，当用户需要查看时可直接从本地缓存中渲染。<br>两种技术的本质：两者的行为是相反的，一个是提前加载，一个是迟缓甚至不加载。懒加载对服务器前端有一定的缓解压力作用，预加载则会增加服务器前端压力。</p>
<h3 id="懒加载（延迟加载）"><a href="#懒加载（延迟加载）" class="headerlink" title="懒加载（延迟加载）"></a>懒加载（延迟加载）</h3><p>页面打开时候，只加载第一屏数据，第二屏以上都用延迟加载，滚动的时候进行加载（如瀑布流）。这样可以显著提高页面加载速度，且更小的并发请求也可以减轻服务器的压力，而且如果用户只浏览首屏的话，还可以节省流量（手机客户端应该用的比较多，减少用户流量）。</p>
<p>比如你看到的一些图片是有圈圈在转，一开始图片的src加载的时候是转转的圈圈（可能也就1K左右），然后根据用户的具体行为再进行图片的延迟加载。</p>
<h3 id="预加载"><a href="#预加载" class="headerlink" title="预加载"></a>预加载</h3><p>预加载：提前加载图片，当用户需要查看时可直接从本地缓存中渲染。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">function loadImage(url, callback)&#123;</div><div class="line">    var img = new Image();</div><div class="line">    img.src = url;</div><div class="line"></div><div class="line">    if(img.complete) &#123;//判断图片加载状态，兼容IE6。</div><div class="line">        //如果图片已经存在浏览器中，直接调用回调函数</div><div class="line">        callback.call(img);</div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    img.onload = function()&#123;</div><div class="line">        img.onload = null;</div><div class="line">        callback.call(img);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;img src=&quot;http://img3.douban.com/lpic/s24418088.jpg&quot; alt=&quot;&quot; id=&quot;img&quot;&gt;</div><div class="line">    &lt;script&gt;</div><div class="line">        window.onload = function()&#123;</div><div class="line">            var img = new Image();</div><div class="line">            img.onload = function()&#123;</div><div class="line">                alert(&quot;加载完全&quot;);</div><div class="line">            &#125;</div><div class="line">            img.src = &quot;http://www.2cto.com/uploadfile/Collfiles/20141017/2014101709072456.png&quot;;</div><div class="line">            </div><div class="line">            var img = document.getElementById(&quot;img&quot;);</div><div class="line">            img.onmouseover = function()&#123;</div><div class="line">                img.src = &quot;http://www.2cto.com/uploadfile/Collfiles/20141017/2014101709072456.png&quot;;</div><div class="line">            &#125;;</div><div class="line">            img.onmouseout = function()&#123;</div><div class="line">                img.src= &quot;http://img3.douban.com/lpic/s24418088.jpg&quot;;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &lt;/script&gt;</div></pre></td></tr></table></figure>
<h3 id="国外网站的流行加载方式"><a href="#国外网站的流行加载方式" class="headerlink" title="国外网站的流行加载方式"></a>国外网站的流行加载方式</h3><p>Pinterest\Google的图片加载方式是先加载出一个与原图片相同大小与相似背景的纯色<code>DIV</code>。（利用聚合算法求出相近的背景色）<br>然后再加载完整的图片。<img src="http://img1.vued.vanthink.cn/vued058f4fcad7f61f95e7682b64178511ef.png" alt="image"><br>详情查看<a href="">演示地址</a><br>我们称之为这种效果为Color Placeholder [色彩预置]，当图片加载的时候，我们优先显示其所在容器的背景颜色（如同很多会显示一个加载的gif），由于受限于不同的图片和大小，因此相比与齐刷刷的加载gif，不同色块体验可能更好吧(至少Pinterest Google这么认为吧)。</p>
<p>medium的做法先加载一张缩略图，给缩略图添加滤镜效果，缩略图添加完成后再加载大图。这样就给用户一种平滑过渡的效果，效果非常赞（有种毛玻璃的感觉）。<br>原作者将代码放到了<a href="http://codepen.io/jmperez/pen/yYjPER" target="_blank" rel="external">codepen</a>上,而作者也适用了CSS的blur滤镜。（代码中的图片来源需要翻墙获得）<br>为了方便演示，我直接下载下来，可以通过<a href="">演示地址</a>去查看源代码。</p>
<p>这样做的好处是：</p>
<ul>
<li>延迟加载：使用JS控制图片加载可以自由的控制什么样的图片去完成加载，当所有的小图完成加载后，JS可以实现加载在所在可视区域的大图完成渲染。</li>
<li>更好内容预置：那些缩略图很小，几乎2kb左右，再加模糊效果，这样的效果会比单纯的底色好很多。</li>
<li>定制图片大小：Medium定制了很多不同的图片，根据用户的不同设备，从而展示出不一样大小的图片。</li>
</ul>
<p><a href="http://www.cnblogs.com/tugenhua0707/p/3515292.html" target="_blank" rel="external">JS图片延迟加载分析及简单的demo</a><br><a href="http://www.cnblogs.com/Leo_wl/p/3526254.html" target="_blank" rel="external">javascript图片懒加载与预加载的分析</a><br><a href="http://www.jackpu.com/shi-xian-lei-si-pinterest-de-tu-pian-yu-jia-zai-gong-neng/" target="_blank" rel="external">实现类似Pinterest 的图片预加载功能</a><br><a href="http://www.jackpu.com/medium-shi-ru-he-zuo-tu-pian-jia-zai-de/" target="_blank" rel="external">[译]Medium 是如何优化图片加载的</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/10/荷兰国旗问题/" itemprop="url">
                  荷兰国旗问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-10T20:41:02+08:00" content="2016-10-10">
              2016-10-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/数据结构与算法/" itemprop="url" rel="index">
                    <span itemprop="name">数据结构与算法</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/10/荷兰国旗问题/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/10/荷兰国旗问题/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://www.cnblogs.com/gnuhpc/archive/2012/12/21/2828166.html" target="_blank" rel="external">参考博客</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">function exch(arr, i, j) &#123;</div><div class="line">    var t = arr[i];</div><div class="line">    arr[i] = arr[j];</div><div class="line">    arr[j] = t;</div><div class="line">&#125;</div><div class="line">function partition(items, left, right)&#123;</div><div class="line">    var pivot = items[Math.floor(right + left) / 2],</div><div class="line">        i = left,</div><div class="line">        j = right;</div><div class="line"></div><div class="line">    while(i &lt;= j) &#123;</div><div class="line">        while(items[i] &lt;pivot)&#123;</div><div class="line">            i++;</div><div class="line">        &#125;</div><div class="line">        while(items[j] &gt; pivot)&#123;</div><div class="line">            j--;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        if(i &lt;= j)&#123;</div><div class="line">            exch(items, i, j);</div><div class="line">            i++;</div><div class="line">            j--;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return i;</div><div class="line">&#125;</div><div class="line"></div><div class="line">function quickSort(items, left, right)&#123;</div><div class="line">    var index;</div><div class="line">    if(items.length &gt; 1)&#123;</div><div class="line">        index = partition(items, left, right);</div><div class="line">        if(left &lt; index - 1)&#123;</div><div class="line">            quickSort(items, left, index - 1);</div><div class="line">        &#125;</div><div class="line">        if(index &lt; right)&#123;</div><div class="line">            quickSort(items, index, right);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return items;</div><div class="line">&#125;</div><div class="line"></div><div class="line">//var result =quickSort(items, 0, items.length-1);</div></pre></td></tr></table></figure>
<p>以上是快排的思想，三向快速排序还是没做出来，不过感觉很接近了。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/10/记一发JS深度克隆/" itemprop="url">
                  记一发JS深度克隆
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-10T16:57:00+08:00" content="2016-10-10">
              2016-10-10
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/10/记一发JS深度克隆/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/10/记一发JS深度克隆/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="JS的两种数据类型"><a href="#JS的两种数据类型" class="headerlink" title="JS的两种数据类型"></a>JS的两种数据类型</h2><p>基本类型（包括undefined,Null,boolean,String,Number），按值传递；<br>引用类型（包括数组，对象），按址传递，引用类型在值传递的时候是内存中的地址。 </p>
<h3 id="克隆或者拷贝分为2种："><a href="#克隆或者拷贝分为2种：" class="headerlink" title="克隆或者拷贝分为2种："></a>克隆或者拷贝分为2种：</h3><p>浅度克隆： 对于基本类型为值传递，对象按照引用传递（JS中有引用传递的概念么）<br>深度克隆：所有元素或属性均完全克隆，并于原引用类型完全独立，即，在后面修改对象的属性的时候，原对象不会被修改。</p>
<h3 id="简单数组克隆slice"><a href="#简单数组克隆slice" class="headerlink" title="简单数组克隆slice()"></a>简单数组克隆slice()</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">arrayObj.slice(start, [end])</div></pre></td></tr></table></figure>
<p>slice 方法一直复制到 end 所指定的元素，但是不包括该元素。如果 start 为负，将它作为 length + start处理，此处 length 为数组的长度。如果 end 为负，就将它作为 length + end 处理，此处 length 为数组的长度。如果省略 end ，那么 slice 方法将一直复制到 arrayObj 的结尾。如果 end 出现在 start 之前，不复制任何元素到新数组中。</p>
<h3 id="简单数组克隆soncat"><a href="#简单数组克隆soncat" class="headerlink" title="简单数组克隆soncat()"></a>简单数组克隆soncat()</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">arrayObject.concat(arrayX,arrayX,......,arrayX)</div></pre></td></tr></table></figure>
<p>返回一个新的数组。该数组是通过把所有 arrayX 参数添加到 arrayObject 中生成的。如果要进行 concat() 操作的参数是数组，那么添加的是数组中的元素，而不是数组。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var arr = [&quot;One&quot;,&quot;Two&quot;,&quot;Three&quot;];</div><div class="line"></div><div class="line">var arrtooo = arr.concat();</div><div class="line">arrtooo[1] = &quot;set Map To&quot;;</div><div class="line">console.log(&quot;数组的原始值：&quot; + arr + &quot;&lt;br /&gt;&quot;);//Export:数组的原始值：One,Two,Three</div><div class="line">console.log(&quot;数组的新值：&quot; + arrtooo + &quot;&lt;br /&gt;&quot;);//Export:数组的新值：One,set Map To,Three</div></pre></td></tr></table></figure></p>
<p>使用concat()和slice()的要求是 <em>数组中没有引用类型值</em>。</p>
<h3 id="对象深度拷贝"><a href="#对象深度拷贝" class="headerlink" title="对象深度拷贝"></a>对象深度拷贝</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">var a=&#123;name:&apos;yy&apos;,age:26&#125;;</div><div class="line">var b=new Object();</div><div class="line"></div><div class="line"></div><div class="line">b.name=a.name;</div><div class="line">b.age=a.age;</div><div class="line">a.name=&apos;xx&apos;;</div><div class="line">console.log(b);//Object &#123; name=&quot;yy&quot;, age=26&#125;</div><div class="line">console.log(a);//Object &#123; name=&quot;xx&quot;, age=26&#125;</div><div class="line"></div><div class="line">//简单来说，就是遍历每个对象的属性，再赋值给新的对象</div><div class="line">var deepCopy= function(source) &#123; </div><div class="line">var result=&#123;&#125;;</div><div class="line">for (var key in source) &#123;</div><div class="line">      result[key] = typeof source[key]===&quot;object&quot;? deepCoyp(source[key]): source[key];</div><div class="line">   &#125; </div><div class="line">   return result; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="全能型"><a href="#全能型" class="headerlink" title="全能型"></a>全能型</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">function cloneObject(obj)&#123;</div><div class="line">    if(typeof(obj)!=&quot;object&quot; || obj === null) return obj;</div><div class="line">    var o = Obejct.prototype.string.call(obj) === &quot;[object Array]&quot;? [] : &#123;&#125;;</div><div class="line">    for(var i in obj)&#123;</div><div class="line">        if(obj.hasOwnProperty(i))&#123;</div><div class="line">            o[i] = typeof obj[i] === &quot;object&quot; ? cloneObject(obj[i]): obj[i];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return o;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>首先如果是基本类型值或者是null，则直接返回。<br>判断当前属性是否是引用类型，如果是数组或者对象，创建相应类型变量。<br>使用 hasOwnProperty() 方法，排除继承的属性。</p>
<h3 id="JSON克隆"><a href="#JSON克隆" class="headerlink" title="JSON克隆"></a>JSON克隆</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var s = JSON.stringify( obj ); </div><div class="line">var o = JSON.parse( s );</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/08/函数节流和函数去抖/" itemprop="url">
                  函数节流和函数去抖
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-08T23:49:14+08:00" content="2016-10-08">
              2016-10-08
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/08/函数节流和函数去抖/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/08/函数节流和函数去抖/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h3 id="函数去抖与函数节流"><a href="#函数去抖与函数节流" class="headerlink" title="函数去抖与函数节流"></a>函数去抖与函数节流</h3><p>函数节流的本意是间隔函数再拖延一定的时间执行。<br>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/10/08/函数节流和函数去抖/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Zaynex" />
          <p class="site-author-name" itemprop="name">Zaynex</p>
          <p class="site-description motion-element" itemprop="description">但行好事，莫问前程</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">77</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">74</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/Zaynex" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/xi-wen-zheng" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-zhihu"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zaynex</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"zaynex"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

</body>
</html>
